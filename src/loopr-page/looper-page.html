<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<dom-module id="loopr-page">
    <template>
        <style is="custom-style" include="iron-flex iron-flex-alignment"></style>
        <style include="shared-styles">
         :host {
            display: block;
        }
        </style>
        <app-header-layout has-scrolling-region fullbleed>
            <app-header slot="header" fixed effects="waterfall">
                <slot name="secondary-toolbar"></slot>
            </app-header>
            <slot></slot>
        </app-header-layout>
    </template>
    <script>
    class LooprPage extends Polymer.Element {
        static get is() { return 'loopr-page'; }

        static get properties() {
            return {};
        }
        ready() {
            super.ready();
  
            let app = document.querySelector("my-app");
            if (app.inited) {
              
                let initedPage =app.initedPage
                let initedPageObj = app.$.pages.querySelector("page-"+initedPage)
                let sections = initedPageObj.shadowRoot.querySelectorAll('div.sections');
                sections.forEach((v) => v.removeAttribute("unresolved"));
                let initedIrons = initedPageObj.shadowRoot.querySelector("iron-pages")
                initedIrons && initedIrons.childNodes.forEach( (node) => node.nodeType ===1 && node.shadowRoot && node.shadowRoot.querySelectorAll('div.sections').forEach(v => v.removeAttribute("unresolved") ) )
                let currentSections = this.querySelectorAll('div.sections');
                currentSections.forEach((v) => v.removeAttribute("unresolved"));

                let subPages = this.querySelector("iron-pages");
                subPages && subPages.childNodes.forEach( (node) => node.nodeType ===1 && node.shadowRoot && node.shadowRoot.querySelectorAll('div.sections').forEach(v => v.removeAttribute("unresolved") ) )
            }

        }
        
    }

    window.customElements.define(LooprPage.is, LooprPage);
    </script>
</dom-module>
